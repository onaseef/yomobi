/*!
* Aloha Editor
* Author & Copyright (c) 2010 Gentics Software GmbH
* aloha-sales@gentics.com
* Licensed unter the terms of http://www.aloha-editor.com/license.html
*/
define(["aloha/core","aloha/jquery","aloha/contenthandlermanager","aloha/console","vendor/sanitize"],function(Aloha,jQuery,ContentHandlerManager,console){function initSanitize(){var filter=["restricted","basic","relaxed"],config=Aloha.defaults.supports;Aloha.settings.contentHandler.sanitize&&jQuery.inArray(Aloha.settings.contentHandler.sanitize,filter)>-1?config=eval("Aloha.defaults.sanitize."+Aloha.settings.contentHandler.sanitize):config=Aloha.defaults.sanitize.relaxed,Aloha.settings.contentHandler.allows&&(config=Aloha.settings.contentHandler.allows),config.filters=[function(e){return e.contentEditable!="false"}],sanitize=new Sanitize(config)}var sanitize;Aloha.defaults.sanitize||(Aloha.defaults.sanitize={}),Aloha.defaults.sanitize.restricted={elements:["b","em","i","strong","u","p","span","div","br"]},Aloha.defaults.sanitize.basic={elements:["a","abbr","b","blockquote","br","cite","code","dd","dl","dt","em","i","li","ol","p","pre","q","small","strike","strong","sub","sup","u","ul"],attributes:{a:["href"],blockquote:["cite"],q:["cite"],abbr:["title"]},protocols:{a:{href:["ftp","http","https","mailto","__relative__"]},blockquote:{cite:["http","https","__relative__"]},q:{cite:["http","https","__relative__"]}}},Aloha.defaults.sanitize.relaxed={elements:["a","abbr","b","blockquote","br","caption","cite","code","col","colgroup","dd","dl","dt","em","h1","h2","h3","h4","h5","h6","i","img","li","ol","p","pre","q","small","strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","tr","u","ul","span","hr","object","div"],attributes:{a:["href","title","id","class","data-gentics-aloha-repository","data-gentics-aloha-object-id"],div:["id","class"],abbr:["title"],blockquote:["cite"],br:["class"],col:["span","width"],colgroup:["span","width"],img:["align","alt","height","src","title","width","class"],ol:["start","type"],q:["cite"],table:["summary","width"],td:["abbr","axis","colspan","rowspan","width"],th:["abbr","axis","colspan","rowspan","scope","width"],ul:["type"],span:["class"]},protocols:{a:{href:["ftp","http","https","mailto","__relative__"]},blockquote:{cite:["http","https","__relative__"]},img:{src:["http","https","__relative__"]},q:{cite:["http","https","__relative__"]}}};var SanitizeContentHandler=ContentHandlerManager.createHandler({handleContent:function(e){return typeof sanitize=="undefined"&&initSanitize(),typeof e=="string"?e=jQuery("<div>"+e+"</div>").get(0):e instanceof jQuery&&(e=jQuery("<div>").append(e).get(0)),jQuery("<div>").append(sanitize.clean_node(e)).html()}});return SanitizeContentHandler});